This is the refactor branch of i386chat_server.
